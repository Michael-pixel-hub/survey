# Документация к API Shop-survey

> Текущая версия API: **1.0**

> Адрес API: https://api.shop-survey.ru/v1/survey/

Эта документация описывает методы работы с API для приложения Shop-survey.

**Shop-Survey состоит из следующих базовых приложений:**

- **[Главное приложение](https://admin.shop-survey.ru/)** - включает в себя все таблицы с данными, такие как пользователи, задачи, выполнение задач, инструменты импорта и экспорта, платежи, отчеты, настройки и т.д. Функционирует в качестве веб-сервиса и управляется [Интерфейсом администрированиия](https://admin.shop-survey.ru/).

- **[Telegram-бот](https://t.me/Serveyor_bot)** - включает в себя таблицы для работы с Telegram-ботом строки, сообщения, а также инструменты для запуска бота и рассылки сообщений. Работает в [Telegram](https://telegram.org/).

- **[Агент](https://t.me/Serveyor_bot)** - подсистема внутри Shop-survey, обеспечивающая процесс продажи товаров дистрибьюторам. Включает в себя данные о товарах, номенклатурных группах, заказах и т.д. Работает внутри основного бота под Telegram.

- **[Профи](https://t.me/surveyorpro_bot)** - приложение для заказа заданий на выполнение через Telegram-бот сторонними пользователями. Работает как отдельный [Telegram-бот](https://t.me/surveyorpro_bot).

## Работа с API

Работа с API осуществляется по шифрованному протоколу **HTTPS**. С API можно работать как посредством GET, POST, DELETE запросов так и через браузер [ссылка](https://api.shop-survey.ru/).

## Авторизация

В случае с работой из браузера можно использовать логин и пароль для доступа в [Интерфейс администрированиия](https://admin.shop-survey.ru/).
Пользователя в этом случае заводит администратор системы.

Для методов HTTPS посредством GET, POST, DELETE нужна аутентификация, кроме открытых методов, для открытых методов аутентификация в API не нужна.

**В этой документации описаны только открытые методы.** Поэтому для ее работы ключи не нужны.

> Все запросы, требующие аутентификации для конкретного пользователя используют API Ключ этого пользователя. Этот ключ выдается при регистрации пользователя в системе.
>
> Смотрите раздел [регистрация пользователя](/survey/#регистрация-пользователя).

## Форматы данных

В данный момент приложение поддерживает следующие форматы данных:

- [JSON](https://en.wikipedia.org/wiki/JSON) - используется по умолчанию
- API - через браузер

> Работа через браузер предназначена только для визуализации данных и имеет ограниченный функционал. Вы не сможете заполнить некоторые поля, которые описаны в этой документации через этот формат.

Для указания формата данных вы можете использовать переменную `format` при передачи параметров API. Например:
```http
GET /v1/survey/public/tasks/?format=json HTTP/1.1
```

## Заголовки

### Заголовки запросов

Ниже перечислены заголовки, которые влияют на поведение сервера:

- `Content-Type` - указывает серверу тип содержимого в вашем запросе. Укажите application/json для запросов Json. Необходим для CREATE и UPDATE запросов.
- `Accept` - указывает серверу на предпочитаемый формат ответа. По умолчанию application/json.
- `Accept-Encoding` - укажите в этом заголовке значения gzip, deflate чтобы сервер сжал ответ с помощью gzip, не указывайте заголовок, если вам нужен ответ без сжатия.

### Заголовки ответов

- `Content-Type` - формат полученных данных.
- `Allow`: доступные методы, которые вы можете использовать для данного url. Могут быть GET, POST, HEAD, OPTIONS.

## Коды ответов сервера
- `200` - запрос успешно выполнен.
- `201` - запись успешно создана.
- `400` - указаны неверные данные. Может возникнуть, когда вы указываете данные в неверном формате или не все требуемые данные.
- `404` - не найдена запись или адрес. Возникает при поиске несуществующих объектов.
- `405` - этот метод не доступен. Возникает, когда вы пытаетесь сделать UPDATE записи, который она не поддерживает или получить информацию о записи, о которой получить ее нельзя.
- `500` - ошибка со стороны сервера (обратитесь к администратору).

## Общие параметры запросов
**Page** - постраничная навигация


Обычно большие списки объектов дробятся на страницы. С помощью этого параметра можно передавать страницу в списке объектов.

Пример:
```http
GET http://localhost:8000/v1/survey/tasks/?page=2 HTTP/1.1
```

**Format** - формат получаемых данных.

Может быть `api` иили `json`.


Пример:
```http
GET http://localhost:8000/v1/survey/tasks/?format=json HTTP/1.1
```

## Ссылки

**Связанные ресурсы:**

- [API Shop-survey](https://api.shop-survey.ru/)
- [Интерфейс администрирования](https://admin.shop-survey.ru/) (необходим доступ)
- [Ссылка на документацию](/)
